---
admin:
  existingSecret: grafana-admin
env:
  GF_DATE_FORMATS_USE_BROWSER_LOCALE: true
persistence:
  enabled: true
  size: 2Gi
annotations:
  reloader.stakater.com/auto: "true"
sidecar:
  dashboards:
    enabled: true
    labelValue: "1"
    searchNamespace: ALL
    folderAnnotation: grafana_folder
    provider:
      allowUiUpdates: true
      foldersFromFilesStructure: true
  datasources:
    enabled: false
    labelValue: "1"
    searchNamespace: ALL
  alert:
    enabled: false
    labelValue: "1"
    searchNamespace: ALL
dashboards:
  default:
    node-exporter-full:
      # renovate: depName="Node Exporter Full"
      gnetId: 1860
      revision: 41
      datasource: Prometheus
    cloudflared:
      # renovate: depName="Cloudflare Tunnels (cloudflared)"
      gnetId: 17457
      revision: 6
      datasource: Prometheus
    lokiStack:
      # renovate: depName="Loki stack monitoring (Promtail, Loki)"
      gnetId: 14055
      revision: 5
      datasource: Loki
  flux:
    flux-cluster:
      url: https://raw.githubusercontent.com/fluxcd/flux2-monitoring-example/main/monitoring/configs/dashboards/cluster.json
      datasource: Prometheus
    flux-control-plane:
      url: https://raw.githubusercontent.com/fluxcd/flux2-monitoring-example/main/monitoring/configs/dashboards/control-plane.json
      datasource: Prometheus
    flux-logs:
      url: https://raw.githubusercontent.com/fluxcd/flux2-monitoring-example/main/monitoring/configs/dashboards/logs.json
      datasource: Loki
  istio:
    extesions:
      url: https://storage.googleapis.com/istio-release/releases/1.27.1/grafana/istio-extension-dashboard.json
      datasource: Prometheus
    mesh:
      url: https://storage.googleapis.com/istio-release/releases/1.27.1/grafana/istio-mesh-dashboard.json
      datasource: Prometheus
    performance:
      url: https://storage.googleapis.com/istio-release/releases/1.27.1/grafana/istio-performance-dashboard.json
      datasource: Prometheus
    service:
      url: https://storage.googleapis.com/istio-release/releases/1.27.1/grafana/istio-service-dashboard.json
      datasource: Prometheus
    workload:
      url: https://storage.googleapis.com/istio-release/releases/1.27.1/grafana/istio-workload-dashboard.json
      datasource: Prometheus
    pilot:
      url: https://storage.googleapis.com/istio-release/releases/1.27.1/grafana/pilot-dashboard.json
      datasource: Prometheus
    ztunnel:
      url: https://storage.googleapis.com/istio-release/releases/1.27.1/grafana/ztunnel-dashboard.json
      datasource: Prometheus
  programming:
    go-process:
      # renovate: depName="Go Processes"
      gnetId: 11891
      revision: 1
      datasource: Prometheus
    go-host-runtime:
      # renovate: depName="Go Host & Runtime Metrics Dashboard"
      gnetId: 21221
      revision: 1
      datasource: &prometheus-datasource-value
        - name: DS_PROMETHEUS
          value: Prometheus
    nodejs:
      # renovate: depName="Nodejs Metrics"
      gnetId: 11956
      revision: 1
      datasource: Prometheus
    redis:
      # renovate: depName="Redis Dashboard for Prometheus Redis Exporter 1.x"
      gnetId: 763
      revision: 6
      datasource: Prometheus
  minio:
    server:
      # renovate: depName="MinIO Dashboard"
      gnetId: 13502
      revision: 26
      datasource: *prometheus-datasource-value
    bucket:
      # renovate: depName="MinIO Bucket Dashboard"
      gnetId: 19237
      revision: 2
      datasource: *prometheus-datasource-value
    node:
      url: https://raw.githubusercontent.com/minio/minio/master/docs/metrics/prometheus/grafana/node/minio-node.json
      datasource: *prometheus-datasource-value
    replication:
      # renovate: depName="MinIO Replication Dashboard"
      gnetId: 15305
      revision: 5
      datasource: *prometheus-datasource-value
dashboardProviders:
  dashboardproviders.yaml:
    apiVersion: 1
    providers:
      - name: default
        options:
          path: /var/lib/grafana/dashboards/default
      - name: flux
        folder: Flux
        options:
          path: /var/lib/grafana/dashboards/flux
      - name: kubernetes
        folder: Kubernetes
        options:
          path: /var/lib/grafana/dashboards/kubernetes
      - name: istio
        folder: Istio
        options:
          path: /var/lib/grafana/dashboards/istio
      - name: programming
        folder: Programming
        options:
          path: /var/lib/grafana/dashboards/programming
      - name: minio
        folder: MinIO
        options:
          path: /var/lib/grafana/dashboards/minio
datasources:
  datasources.yaml:
    apiVersion: 1
    datasources:
      - name: Prometheus
        type: prometheus
        url: http://monitoring-kube-prometheus-prometheus:9090
        access: proxy
        isDefault: true
      - name: Loki
        type: loki
        access: proxy
        url: http://loki-gateway:80
        version: 1
        isDefault: false
      - name: Alertmanager
        type: alertmanager
        access: proxy
        url: http://monitoring-kube-prometheus-alertmanager:9093
        version: 1
        isDefault: false
        jsonData:
          implementation: prometheus
    deleteDatasources:
      - name: Prometheus
        orgId: 1
      - name: Loki
        orgId: 1
      - name: Alertmanager
        orgId: 1
resources:
  limits:
    cpu: 200m
  requests:
    cpu: 10m
